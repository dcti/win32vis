# RC5DES Win32 Log Visualizer makefile (Borland C++ for Win32 x86)
# feel free to generalize to do Win32 Alpha as well
# see http://www.distributed.net/

EXENAMEG = ../../logvis.exe
OUTPUTPATH = ../../output
COMMONPATH = ../../common
LOGVIS = .


# define variable to existence to enable debugging
#DEBUG=1

# --------------------------------------------

BCCOPTS = /a4 /Vv /x- /xd- /RT- /r /k- /d /w /O2 /O /OS \
  /I$(COMMONPATH) /D_CPU_32BIT_ /DMULTITHREAD /tWM

TLINKOPTS = /aa /x /Tpe /n /B:0x400000

GUI_LIBS = noeh32.lib cw32mt.lib import32.lib

!ifdef DEBUG
BCCOPTS = /v $(BCCOPTS)
TLINKOPTS = /v $(TLINKOPTS)
!else
BCCOPTS = $(BCCOPTS) /DNDEBUG
!endif

# --------------------------------------------

.path.cpp = $(COMMONPATH);$(LOGVIS)
.path.obj = $(OUTPUTPATH)
.path.res = $(OUTPUTPATH)
.path.rc = $(LOGVIS)

# --------------------------------------------

GUI_OBJS =                    \
        $(OUTPUTPATH)/guiapp.obj     \
        $(OUTPUTPATH)/guigraph.obj   \
        $(OUTPUTPATH)/guiwind.obj    \
		$(OUTPUTPATH)/sliderrange.obj	\
		$(OUTPUTPATH)/guiconfig.obj

GUI_RES = $(OUTPUTPATH)/guiwin.res

# --------------------------------------------

.cpp.obj:
        bcc32 -c @&&|
-P $(BCCOPTS) -n$(OUTPUTPATH)
| $< 

.rc.res:
        brcc32 -D_Windows -D_M_IX86 -D__BORLANDC__ -r -w32 -fo$@ -i$(COMMONPATH) $**

# --------------------------------------------

# Actual target
$(EXENAMEG): $(GUI_OBJS) $(GUI_RES)
        tlink32 $(TLINKOPTS) @&&|
c0w32.obj $(GUI_OBJS:/=\),$(EXENAMEG:/=\),,$(GUI_LIBS),,$(GUI_RES:/=\)
|

# --------------------------------------------

